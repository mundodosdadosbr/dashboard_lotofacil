                    try:
                        header = data.read(100).decode('utf-8')
                        data.seek(0)
                    except UnicodeDecodeError:
                        logger.error(f'Erro ao decodificar o arquivo {remote_filename}, movendo para error/')
                        error_path = f"{target_path}error/{datetime.now().strftime('%Y/%m/%d')}/{sanitized_file_name}"
                        data.seek(0)
                        s3_client.upload_fileobj(data, target_bucket, error_path)
                        continue
